{{- "DockerHub\n" | comment "# " -}}
{{- $dh_username := env "DOCKERHUB_USERNAME" -}}
{{- $dh_password := env "DOCKERHUB_PASSWORD" -}}
{{- if (or (eq $dh_username "") (eq $dh_password "")) -}}
{{-   $dh_credentials := (index (lastpass "chezmoi/dockerhub") 0) -}}
{{-   $dh_username = $dh_credentials.username -}}
{{-   $dh_password = $dh_credentials.password -}}
{{- end -}}
export DOCKERHUB_USERNAME="{{ $dh_username }}"
export DOCKERHUB_PASSWORD="{{ $dh_password }}"
dockerlogin() {
  echo "${DOCKERHUB_PASSWORD}" | docker login --username "${DOCKERHUB_USERNAME}" --password-stdin
}

{{- "Terraform\n" | comment "# " -}}
{{- $tf_token := env "TF_TOKEN" -}}
{{- if eq $tf_token "" -}}
{{-   $tf_token = (index (lastpass "chezmoi/terraform") 0).password -}}
{{- end -}}
export TF_TOKEN="{{ $tf_token }}"
tflogin() {
  if [ ! -f "${HOME}/.terraformrc" ]; then
    echo "credentials \"app.terraform.io\" { token = \"${TF_TOKEN}\" }" >"${HOME}/.terraformrc"
  fi
}

{{- "GitHub\n" | comment "# " -}}
{{- $gh_token := env "GITHUB_TOKEN" -}}
{{- if eq $gh_token "" -}}
{{-   $gh_token = (index (lastpass "chezmoi/github") 0).password -}}
{{- end -}}
export GITHUB_TOKEN="{{ $gh_token }}"

